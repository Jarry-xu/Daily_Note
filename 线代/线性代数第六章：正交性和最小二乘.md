---
typora-root-url: .\assets
---

# 线性代数第六章：正交性和最小二乘

[TOC]



## 6.1内积、长度、正交性

### 内积

定义$u,v为R^n中的向量$，$u^Tv$定义为两个向量的内积分，记做$u·v$

内积满足以下性质：

1. 交换律
2. 分配律
3. 数乘可先提出来

### 长度

定义向量$v$的长度为非负数$||v||$，定义为
$$
||v||=\sqrt(v·v)
$$
长度为1的向量叫做单位向量.

把一个向量变为单位向量的过程叫做向量单位化。

### 距离

定义$u,v之间的距离为dis(u,v)$，表示向量$u-v$的长度

$dis(u,v)=||u-v||$

### 正交向量

如果两个向量的内积为零，则两个向量正交

> 两个向量正交的充要条件是$||u+v||^2=||u||^2+||v||^2$(勾股定理)

正交补：垂直于某个子空间的向量的全体集合

定理：

> A的行空间的正交补是A的零空间，且A的列空间的正交补是$A^T$ 的零空间

## 6.2 正交集

> 正交集是指一组向量集合，向量之间互相正交

正交集可构成一组基，叫做正交基

正交基的一些优良性质：

> 假设$\{u_1,u_2,..u_p\}$是子空间W的正交基，对于W中的每个向量都可以用这组正交基线性组合表示,权$c_j=\frac{y·u_j}{u_j·u_j}  $

### 正交投影：向量与向量之间

![1545309391273](C:\Users\85366\AppData\Roaming\Typora\typora-user-images\1545309391273.png)

所以现在求一个向量在另一个向量上的投影就很容易了，而且跟这个向量所在的平面是没有关系的。

### 单位正交集

全部都是由单位向量构成的正交集合就是单位正交集，如果W为单位正交集合生成的子空间，单位正交集就变成了单位正交基。

两个定理：

![1545309844056](C:\Users\85366\AppData\Roaming\Typora\typora-user-images\1545309844056.png)



定理6：

> 一个mxn矩阵U具有单位正交列向量的充分必要条件是$U^TU=I$

> 定理7 U为具有单位正交列的mxn矩阵，x、y是$R^n$中的向量，那么有以下性质
>
> 1. $||Ux||=||x||$
> 2. $(Ux)·(Uy)=x·y$
> 3. $(Ux)·(Uy)=0$的充要条件是$x·y=0$

## 6.3 正交投影 向量与子空间之间

### 投影矩阵

先看一维的情况

![1568178916803](/1568178916803.png)

求解$\lambda=\frac{a^Tb}{a^Ta}$

回代到(1)中可以得到投影矩阵

$f=a\lambda=\frac{aa^T}{a^Ta}b=Pb$

所以投影矩阵就是$P=\frac{aa^T}{a^Ta}$

三维情况

![1568179175004](/1568179175004.png)

![1568179202022](/1568179202022.png)

![1568179225277](/1568179225277.png)

$A\hat x=A(A^TA)^{-1}A^Tb$

所以投影矩阵P为$P=A(A^TA)^{-1}A^T$

### 正交分解定理

![1545310508324](C:\Users\85366\AppData\Roaming\Typora\typora-user-images\1545310508324.png)

证明：

边上我写的是投影y=$k_1u_1+..k_pu_p$，然后有（y-projy)·$u_1$=0

化简可以得到系数k1=上面公式里的式子

其实就是y在各个正交向量上的投影之和

性质：proj（y）是距离y最近的向量，距离最短



定理：



## 6.4  构建标准正交基的格拉姆-施密特方法

### 构造方法：

![1568107345722](/%E6%96%BD%E5%AF%86%E7%89%B9%E5%85%AC%E5%BC%8F.png)

### 标准正交基

将正交向量变为单位向量而已

### 矩阵的QR分解

如果mxn矩阵A列线性无关，那么可以将A分解为QR

Q的列构成了A的列空间的标准正交基，R是一个上三角可逆矩阵且在对角线上的元素为正数



求出Q之后可以左乘$Q^T$可以得到R=$Q^TA$



## 6.5 最小二乘法

原因：Ax=b不相容，所以目的是为了找到一个$\hat{x}$使得尽量接近b

那就是$||b-A\hat{x}||$最小

取$\hat{b}=proj_{colA}b$ 

存在$\hat{x}$使得$A\hat{x}=\hat{b}$



于是可以得到$A^TA\hat{x}=A^Tb$

计算如果$A^TA$，

如果可逆，就直接左乘过去那么方程只有唯一解

如果不可逆，那么就有多种解X，使用增广矩阵去解

另一种方法：使用QR分解去求